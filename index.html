

<!DOCTYPE html>
<html lang="ta">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tuition Manager</title>

    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0d47a1">


    <!-- Fonts: Mukta Malar for Tamil, Inter for English -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Mukta+Malar:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <div class="app-container">

        <!-- HEADER -->
        <header class="app-header">
            <div class="header-content">
                <h1 id="page-title" data-i18n="app_title">роЯрпНропрпВро╖ройрпН роорпЗро▓ро╛ро│ро░рпН</h1>
                <button id="lang-toggle" class="btn-icon" aria-label="Change Language">
                    <span class="lang-text">родрооро┐ро┤рпН</span>
                </button>
            </div>
        </header>

        <!-- MAIN CONTENT AREA -->
        <main id="main-content">

            <!-- VIEW: DASHBOARD (роЯро╛ро╖рпНрокрпЛро░рпНроЯрпН) -->
            <section id="view-dashboard" class="view active">
                <div class="welcome-banner">
                    <h2 data-i18n="welcome">ро╡рогроХрпНроХроорпН!</h2>
                    <p data-i18n="tagline">роЙроЩрпНроХро│рпН ро╡роХрпБрокрпНрокрпБроХро│рпИ роОро│ро┐родро╛роХ роиро┐ро░рпНро╡роХро┐роХрпНроХро╡рпБроорпН.</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card blue">
                        <div class="stat-icon">ЁЯОУ</div>
                        <div class="stat-info">
                            <h3 data-i18n="total_students">роорпКродрпНрод рооро╛рогро╡ро░рпНроХро│рпН</h3>
                            <p class="stat-value" id="dash-total-students">0</p>
                        </div>
                    </div>
                    <div class="stat-card purple">
                        <div class="stat-icon">ЁЯУЕ</div>
                        <div class="stat-info">
                            <h3 data-i18n="today_present">роЗройрпНро▒рпБ ро╡ро░рпБроХрпИ</h3>
                            <p class="stat-value"><span id="dash-present-count">0</span> / <span
                                    id="dash-active-count">0</span></p>
                        </div>
                    </div>
                    <div class="stat-card green">
                        <div class="stat-icon">ЁЯТ░</div>
                        <div class="stat-info">
                            <h3 data-i18n="fees_collected">роЗроорпНрооро╛род ро╡роЪрпВро▓рпН</h3>
                            <p class="stat-value">тВ╣<span id="dash-fees-collected">0</span></p>
                        </div>
                    </div>
                    <div class="stat-card orange">
                        <div class="stat-icon">тЪая╕П</div>
                        <div class="stat-info">
                            <h3 data-i18n="fees_pending">роиро┐ро▓рпБро╡рпИ родрпКроХрпИ</h3>
                            <p class="stat-value">тВ╣<span id="dash-fees-pending">0</span></p>
                        </div>
                    </div>
                </div>

                <div class="section-header">
                    <h3 data-i18n="quick_actions">ро╡ро┐ро░рпИро╡ро╛рой роЪрпЖропро▓рпНроХро│рпН</h3>
                </div>
                <div class="quick-actions">
                    <button class="action-btn" onclick="navigateTo('view-attendance')">
                        <span class="icon">ЁЯУЕ</span>
                        <span data-i18n="mark_attendance">ро╡ро░рпБроХрпИ рокродро┐ро╡рпБ</span>
                    </button>
                    <button class="action-btn" onclick="openFeeModal()">
                        <span class="icon">ЁЯТ░</span>
                        <span data-i18n="add_fee">роХроЯрпНроЯрогроорпН роЪрпЗро░рпН</span>
                    </button>
                    <button class="action-btn" onclick="navigateTo('view-reports')">
                        <span class="icon">ЁЯУК</span>
                        <span data-i18n="reports">роЕро▒ро┐роХрпНроХрпИроХро│рпН</span>
                    </button>
                </div>
            </section>

            <!-- VIEW: STUDENTS (рооро╛рогро╡ро░рпНроХро│рпН) -->
            <section id="view-students" class="view">
                <div class="toolbar">
                    <div class="search-bar">
                        <input type="text" id="student-search" data-i18n-placeholder="search_placeholder"
                            placeholder="родрпЗроЯрпБроХ...">
                    </div>
                    <button class="btn-primary" onclick="openStudentModal()">
                        <span class="plus">+</span> <span data-i18n="add_student">рооро╛рогро╡ро░рпН роЪрпЗро░рпН</span>
                    </button>
                </div>
                <div id="students-list" class="list-container">
                    <!-- Student Cards Injected Here -->
                </div>
            </section>

            <!-- VIEW: ATTENDANCE (ро╡ро░рпБроХрпИ) -->
            <section id="view-attendance" class="view">
                <div class="attendance-controls">
                    <label data-i18n="date">родрпЗродро┐</label>
                    <input type="date" id="att-date">
                </div>

                <div class="attendance-summary">
                    <div class="att-stat"><span class="dot green"></span> <span data-i18n="present">Present</span>:
                        <span id="att-count-present">0</span></div>
                    <div class="att-stat"><span class="dot red"></span> <span data-i18n="absent">Absent</span>: <span
                            id="att-count-absent">0</span></div>
                </div>

                <div class="toolbar">
                    <button class="btn-outline" onclick="markAllPresent()" data-i18n="mark_all_present">роЕройрпИро╡ро░рпБроорпН
                        ро╡ро░рпБроХрпИ</button>
                </div>

                <div id="attendance-list" class="list-container">
                    <!-- Attendance Rows Injected Here -->
                </div>

                <div class="fab-container">
                    <button class="btn-fab" onclick="saveAttendance()" id="btn-save-attendance">
                        ЁЯТ╛
                    </button>
                </div>
            </section>

            <!-- VIEW: FEES (роХроЯрпНроЯрогроорпН) -->
            <section id="view-fees" class="view">
                <div class="toolbar">
                    <button class="btn-primary full-width" onclick="openFeeModal()" data-i18n="add_new_fee">+ рокрпБродро┐роп
                        роХроЯрпНроЯрогроорпН</button>
                </div>

                <div class="tabs-row">
                    <button class="tab-btn active" onclick="switchFeeTab('history')" data-i18n="history">ро╡ро░ро▓ро╛ро▒рпБ</button>
                    <button class="tab-btn" onclick="switchFeeTab('pending')" data-i18n="pending_list">роиро┐ро▓рпБро╡рпИ
                        рокроЯрпНроЯро┐ропро▓рпН</button>
                </div>

                <div id="fee-history-view" class="fee-tab-content">
                    <div class="filter-row">
                        <select id="fee-filter-month">
                            <!-- Options generated dynamically -->
                        </select>
                    </div>
                    <div id="fee-list" class="list-container">
                        <!-- Fee Transactions -->
                    </div>
                </div>

                <div id="fee-pending-view" class="fee-tab-content hidden">
                    <div id="pending-list" class="list-container">
                        <!-- Pending Dues -->
                    </div>
                </div>
            </section>

            <!-- VIEW: REPORTS (роЕро▒ро┐роХрпНроХрпИроХро│рпН) -->
            <section id="view-reports" class="view">
                <div class="report-controls">
                    <label data-i18n="select_month">рооро╛родроорпН родрпЗро░рпНро╡рпБ роЪрпЖропрпНроХ</label>
                    <input type="month" id="report-month">
                    <button class="btn-primary" onclick="generateReport()" data-i18n="generate">роЙро░рпБро╡ро╛роХрпНроХрпБ</button>
                </div>

                <div id="report-output" class="hidden">
                    <div class="report-card">
                        <h3 data-i18n="monthly_summary">рооро╛родро╛роирпНродро┐ро░ роЪрпБро░рпБроХрпНроХроорпН</h3>
                        <div class="report-row">
                            <span data-i18n="working_days">ро╡рпЗро▓рпИ роиро╛роЯрпНроХро│рпН:</span>
                            <span id="rep-working-days" class="bold">0</span>
                        </div>
                        <div class="report-row">
                            <span data-i18n="avg_attendance">роЪро░ро╛роЪро░ро┐ ро╡ро░рпБроХрпИ:</span>
                            <span id="rep-avg-att">0%</span>
                        </div>
                        <div class="report-row">
                            <span data-i18n="fees_collected">ро╡роЪрпВро▓рпН:</span>
                            <span class="green-text">тВ╣<span id="rep-collected">0</span></span>
                        </div>
                        <div class="report-row">
                            <span data-i18n="fees_pending">роиро┐ро▓рпБро╡рпИ:</span>
                            <span class="red-text">тВ╣<span id="rep-pending">0</span></span>
                        </div>
                    </div>

                    <div class="report-actions">
                        <button class="btn-secondary" onclick="exportReportText()" data-i18n="copy_summary">ро╡ро╛роЯрпНро╕рпНроЕрокрпН
                            роЪрпБро░рпБроХрпНроХроорпН роироХро▓рпЖроЯрпБ</button>
                    </div>
                </div>
            </section>

            <!-- VIEW: SETTINGS / BACKUP -->
            <section id="view-settings" class="view">
                <div class="settings-list">
                    <div class="setting-item">
                        <h3 data-i18n="app_language">роорпКро┤ро┐ (Language)</h3>
                        <div class="toggle-group">
                            <button class="btn-sm active" id="btn-lang-ta" onclick="setLanguage('ta')">родрооро┐ро┤рпН</button>
                            <button class="btn-sm" id="btn-lang-en" onclick="setLanguage('en')">English</button>
                        </div>
                    </div>

                    <div class="setting-item">
                        <h3 data-i18n="backup_restore">родрпЗро░рпНро╡рпБ & роорпАроЯрпНрокрпБ (Backup & Restore)</h3>
                        <p class="desc-text" data-i18n="backup_desc">роЙроЩрпНроХро│рпН родро░ро╡рпИрокрпН рокро╛родрпБроХро╛рокрпНрокро╛роХ ро╡рпИродрпНродро┐ро░рпБроХрпНроХ, роЕро╡рпНро╡рокрпНрокрпЛродрпБ
                            роХро╛рокрпНрокрпБрокрпН рокро┐ро░родро┐ роОроЯрпБроХрпНроХро╡рпБроорпН.</p>

                        <button class="btn-secondary full-width" onclick="backupData()">
                            ЁЯУе <span data-i18n="download_backup">родро░ро╡ро┐ро▒роХрпНроХроорпН (Backup)</span>
                        </button>

                        <div class="divider"></div>

                        <label class="btn-secondary full-width file-upload-btn">
                            ЁЯУд <span data-i18n="restore_backup">родро░ро╡рпИ роорпАроЯрпНроЯроорпИ (Restore)</span>
                            <input type="file" id="restore-file" accept=".json" onchange="restoreData(this)">
                        </label>
                    </div>
                </div>
            </section>

        </main>

        <!-- BOTTOM NAVIGATION -->
        <nav class="bottom-nav">
            <button class="nav-item active" onclick="navigateTo('view-dashboard')">
                <span class="icon">ЁЯПа</span>
                <span class="label" data-i18n="home">роорпБроХрокрпНрокрпБ</span>
            </button>
            <button class="nav-item" onclick="navigateTo('view-students')">
                <span class="icon">ЁЯСитАНЁЯОУ</span>
                <span class="label" data-i18n="students">рооро╛рогро╡ро░рпН</span>
            </button>
            <button class="nav-item" onclick="navigateTo('view-attendance')">
                <span class="icon">тЬЕ</span>
                <span class="label" data-i18n="attendance">ро╡ро░рпБроХрпИ</span>
            </button>
            <button class="nav-item" onclick="navigateTo('view-fees')">
                <span class="icon">ЁЯТ╡</span>
                <span class="label" data-i18n="fees">роХроЯрпНроЯрогроорпН</span>
            </button>
            <button class="nav-item" onclick="navigateTo('view-settings')">
                <span class="icon">тЪЩя╕П</span>
                <span class="label" data-i18n="settings">роЕроорпИрокрпНрокрпБ</span>
            </button>
        </nav>

        <!-- MODALS -->

        <!-- Add/Edit Student Modal -->
        <div id="modal-student" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modal-student-title" data-i18n="add_student">рокрпБродро┐роп рооро╛рогро╡ро░рпН</h2>
                    <button class="btn-close" onclick="closeModal('modal-student')">&times;</button>
                </div>
                <form id="form-student">
                    <input type="hidden" id="st-id">

                    <div class="form-group">
                        <label data-i18n="student_name">рокрпЖропро░рпН</label>
                        <input type="text" id="st-name" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="age">ро╡ропродрпБ</label>
                            <input type="number" id="st-age">
                        </div>
                        <div class="form-group">
                            <label data-i18n="class">ро╡роХрпБрокрпНрокрпБ</label>
                            <select id="st-class">
                                <option value="LKG">LKG</option>
                                <option value="UKG">UKG</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label data-i18n="parent_mobile">рокрпЖро▒рпНро▒рпЛро░рпН & роорпКрокрпИро▓рпН</label>
                        <input type="text" id="st-parent" data-i18n-placeholder="parent_name"
                            placeholder="рокрпЖро▒рпНро▒рпЛро░рпН рокрпЖропро░рпН">
                        <input type="tel" id="st-mobile" pattern="[0-9]{10}" placeholder="9998887776"
                            style="margin-top: 5px;">
                    </div>

                    <div class="form-group">
                        <label data-i18n="subjects">рокро╛роЯроЩрпНроХро│рпН</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="subject" value="Maths"> Maths</label>
                            <label><input type="checkbox" name="subject" value="Science"> Science</label>
                            <label><input type="checkbox" name="subject" value="English"> English</label>
                            <label><input type="checkbox" name="subject" value="Tamil"> Tamil</label>
                            <label><input type="checkbox" name="subject" value="Social"> Social</label>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="fee_plan">роХроЯрпНроЯрог роорпБро▒рпИ</label>
                            <select id="st-fee-plan">
                                <option value="Monthly">Monthly</option>
                                <option value="Weekly">Weekly</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label data-i18n="amount">родрпКроХрпИ (тВ╣)</label>
                            <input type="number" id="st-fee-amount" required>
                        </div>
                    </div>

                    <button type="submit" class="btn-primary full-width" data-i18n="save">роЪрпЗрооро┐роХрпНроХ</button>
                    <!-- Delete button only shows for Edit mode via JS -->
                    <button type="button" id="btn-delete-student" class="btn-danger full-width hidden"
                        style="margin-top: 10px;" data-i18n="delete">роирпАроХрпНроХрпБроХ</button>
                </form>
            </div>
        </div>

        <!-- Add Fee Modal -->
        <div id="modal-fee" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 data-i18n="add_fee">роХроЯрпНроЯрогроорпН роЪрпЗро░рпН</h2>
                    <button class="btn-close" onclick="closeModal('modal-fee')">&times;</button>
                </div>
                <form id="form-fee">
                    <div class="form-group">
                        <label data-i18n="student">рооро╛рогро╡ро░рпН</label>
                        <select id="fee-student" required onchange="autoFillFeeData()"></select>
                    </div>

                    <div class="form-group">
                        <label data-i18n="month">рооро╛родроорпН</label>
                        <input type="month" id="fee-month" required>
                    </div>

                    <div class="form-group">
                        <label data-i18n="amount_paid">роЪрпЖро▓рпБродрпНродро┐роп родрпКроХрпИ</label>
                        <input type="number" id="fee-amount" required>
                    </div>

                    <div class="form-group">
                        <label data-i18n="payment_mode">роорпБро▒рпИ</label>
                        <select id="fee-mode">
                            <option value="Cash">Cash (ро░рпКроХрпНроХроорпН)</option>
                            <option value="GPay">GPay</option>
                            <option value="PhonePe">PhonePe</option>
                            <option value="Bank">Bank Transfer</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label data-i18n="notes">роХрпБро▒ро┐рокрпНрокрпБ (Notes)</label>
                        <input type="text" id="fee-notes">
                    </div>

                    <button type="submit" class="btn-success full-width" data-i18n="save_payment">рокродро┐ро╡рпБ роЪрпЖропрпН</button>
                </form>
            </div>
        </div>

    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden"></div>

    <script src="script.js"></script>
</body>

</html>